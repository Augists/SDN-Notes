<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Control and Data Plane Separation | Software Defined Network</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Notes of Software Defined Network on Coursera">
    
    <link rel="preload" href="/SDN-Notes/assets/css/0.styles.d4b88980.css" as="style"><link rel="preload" href="/SDN-Notes/assets/js/app.ebe7fed2.js" as="script"><link rel="preload" href="/SDN-Notes/assets/js/2.4a1859a1.js" as="script"><link rel="preload" href="/SDN-Notes/assets/js/9.c2f25c60.js" as="script"><link rel="prefetch" href="/SDN-Notes/assets/js/10.1df7edba.js"><link rel="prefetch" href="/SDN-Notes/assets/js/11.c7a4c90d.js"><link rel="prefetch" href="/SDN-Notes/assets/js/12.e668dbff.js"><link rel="prefetch" href="/SDN-Notes/assets/js/13.91ff2bfa.js"><link rel="prefetch" href="/SDN-Notes/assets/js/14.27d79a28.js"><link rel="prefetch" href="/SDN-Notes/assets/js/15.f644f0f0.js"><link rel="prefetch" href="/SDN-Notes/assets/js/3.e1ea490f.js"><link rel="prefetch" href="/SDN-Notes/assets/js/4.5699b6ed.js"><link rel="prefetch" href="/SDN-Notes/assets/js/5.64c3ed7f.js"><link rel="prefetch" href="/SDN-Notes/assets/js/6.1773cda6.js"><link rel="prefetch" href="/SDN-Notes/assets/js/7.3c8905b8.js"><link rel="prefetch" href="/SDN-Notes/assets/js/8.f291c437.js">
    <link rel="stylesheet" href="/SDN-Notes/assets/css/0.styles.d4b88980.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/SDN-Notes/" class="home-link router-link-active"><!----> <span class="site-name">Software Defined Network</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/SDN-Notes/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Augists" class="dropdown-title"><span class="title">Augists</span> <span class="arrow down"></span></button> <button type="button" aria-label="Augists" class="mobile-dropdown-title"><span class="title">Augists</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/Augists" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://augists.top" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/SDN-Notes/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Augists" class="dropdown-title"><span class="title">Augists</span> <span class="arrow down"></span></button> <button type="button" aria-label="Augists" class="mobile-dropdown-title"><span class="title">Augists</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/Augists" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://augists.top" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/SDN-Notes/" aria-current="page" class="sidebar-link">Table of Contents</a></li><li><a href="/SDN-Notes/SDN/Overview.html" class="sidebar-link">Overview</a></li><li><a href="/SDN-Notes/SDN/Module1.html" class="sidebar-link">Module 1: History and evolution of SDN</a></li><li><a href="/SDN-Notes/SDN/Module2.html" aria-current="page" class="active sidebar-link">Module 2: Control and data plane separation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/SDN-Notes/SDN/Module2.html#mininet-topologies-and-mininet-python-api" class="sidebar-link">Mininet Topologies and Mininet Python API</a></li><li class="sidebar-sub-header"><a href="/SDN-Notes/SDN/Module2.html#mininet-instructions" class="sidebar-link">Mininet Instructions</a></li><li class="sidebar-sub-header"><a href="/SDN-Notes/SDN/Module2.html#control-data-separation" class="sidebar-link">Control/Data Separation</a></li><li class="sidebar-sub-header"><a href="/SDN-Notes/SDN/Module2.html#routing-control-platform" class="sidebar-link">Routing Control Platform</a></li><li class="sidebar-sub-header"><a href="/SDN-Notes/SDN/Module2.html#the-4d-network-architecture" class="sidebar-link">The 4D Network Architecture</a></li></ul></li><li><a href="/SDN-Notes/SDN/Module3.html" class="sidebar-link">Module 3: Virtual networking</a></li><li><a href="/SDN-Notes/SDN/Module4&amp;5.html" class="sidebar-link">Modules 4 &amp; 5: SDN Nuts and Bolts</a></li><li><a href="/SDN-Notes/SDN/Module6.html" class="sidebar-link">Module 6: Programming SDNs</a></li><li><a href="/SDN-Notes/SDN/Module7.html" class="sidebar-link">Module 7: Use Cases</a></li><li><a href="/SDN-Notes/SDN/Module8.html" class="sidebar-link">Module 8: Looking Forward</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="control-and-data-plane-separation"><a href="#control-and-data-plane-separation" class="header-anchor">#</a> Control and Data Plane Separation</h1> <p></p><div class="table-of-contents"><ul><li><a href="#control-and-data-plane-separation">Control and Data Plane Separation</a><ul><li><a href="#mininet-topologies-and-mininet-python-api">Mininet Topologies and Mininet Python API</a><ul><li><a href="#testing-a-simple-mininet-setup">Testing a Simple Mininet Setup</a></li><li><a href="#basic-miniet-command-line">Basic Miniet Command Line</a></li><li><a href="#trying-out-different-mininet-topologies">Trying Out Different Mininet Topologies</a></li><li><a href="#how-mn-works-mn-executes-python">How mn Works: mn executes Python</a></li><li><a href="#writing-your-own-mininet-topologies">Writing Your Own Mininet Topologies</a></li><li><a href="#more-complicated-topology-generation">More Complicated Topology Generation</a></li><li><a href="#thing-not-covered">Thing Not Covered</a></li></ul></li><li><a href="#mininet-instructions">Mininet Instructions</a><ul><li><a href="#notations">Notations</a></li><li><a href="#command-breakdown">Command Breakdown</a></li><li><a href="#mininet-basic-commands">Mininet Basic Commands</a></li><li><a href="#ping-test">Ping Test</a></li><li><a href="#benchmark-controller-with-iperf">Benchmark Controller with iperf</a></li><li><a href="#changing-link-parameters">Changing Link Parameters</a></li><li><a href="#terms">Terms</a></li></ul></li><li><a href="#control-data-separation">Control/Data Separation</a><ul><li><a href="#overview">Overview</a><ul><li><a href="#what-is-control-data-separation">What is control/data separation?</a></li><li><a href="#why-separate-the-control-and-data-planes">Why Separate the Control and Data Planes?</a></li><li><a href="#opportunities-where-separation-helps">Opportunities: Where Separation Helps</a></li><li><a href="#example-data-centers-yahoo">Example: Data Centers (Yahoo!)</a></li><li><a href="#example-at-t-irscp-commercial-rcp-remote-procedure-call">Example: AT&amp;T IRSCP (commercial RCP (remote procedure call))</a></li><li><a href="#two-continual-challenges">Two Continual Challenges</a></li></ul></li><li><a href="#opportunities-in-various-domains">Opportunities in various domains</a><ul><li><a href="#interdomain-routing-constrained-policies">Interdomain Routing: Constrained Policies</a></li><li><a href="#example-maintenance-dry-out">Example: Maintenance Dry-out</a></li><li><a href="#example-egress-selection">Example: Egress Selection</a></li><li><a href="#example-better-bgp-security">Example: Better BGP Security</a></li><li><a href="#example-data-centers-cost">Example: Data Centers (Cost)</a></li><li><a href="#example-data-center-addressing">Example: Data Center Addressing</a></li><li><a href="#other-opportunities">Other Opportunities</a></li></ul></li><li><a href="#challenges-in-separating-the-data-and-control-planes">Challenges in Separating the Data and Control Planes</a><ul><li><a href="#scalability-rcp">Scalability: RCP</a><ul><li><a href="#scalability-principles-from-rcp-design">Scalability: Principles from RCP Design</a></li></ul></li><li><a href="#scalability-onix">Scalability: ONIX</a></li><li><a href="#reliability-rcp">Reliability: RCP</a><ul><li><a href="#potential-consistency-problem">Potential Consistency Problem</a><ul><li><a href="#single-rcp-under-partition">Single RCP Under Partition</a></li><li><a href="#multiple-rcps-under-partition">Multiple RCPs Under Partition</a></li></ul></li></ul></li><li><a href="#reliability-onix">Reliability: ONIX</a></li></ul></li><li><a href="#summary">Summary</a></li></ul></li><li><a href="#routing-control-platform">Routing Control Platform</a><ul><li><a href="#problems-with-bgp">Problems with BGP</a></li><li><a href="#routing-control-platform">Routing Control Platform</a><ul><li><a href="#decomposed-configureation-state">Decomposed Configureation State</a><ul><li><a href="#rcp-centralize-configuration">RCP: Centralize COnfiguration</a></li></ul></li></ul></li><li><a href="#bgp-interacts-with-underlying-protocols">BGP Interacts with Underlying Protocols</a><ul><li><a href="#rcp-compute-routes-w-complete-info">RCP: Compute Routes w/Complete info</a></li><li><a href="#getting-from-here-to-there">Getting From Here to There</a><ul><li><a href="#phase-1-control-protocol-interactions">Phase 1: Control Protocol Interactions</a><ul><li><a href="#application-controlling-path-changes">Application: Controlling Path Changes</a></li></ul></li><li><a href="#phase-2-as-wide-policy">Phase 2: AS-Wide Policy</a><ul><li><a href="#application-efficient-aggregation">Application: Efficient Aggregation</a></li></ul></li><li><a href="#phase-3-all-ases-have-rcps">Phase 3: All ASes Have RCPs</a><ul><li><a href="#application-more-flexible-routing">Application: More Flexible Routing</a></li></ul></li></ul></li></ul></li><li><a href="#summary">Summary</a></li></ul></li><li><a href="#the-4d-network-architecture">The 4D Network Architecture</a><ul><li><a href="#conventional-ip-routers">Conventional IP Routers</a></li><li><a href="#goal-remove-conventional-control-plane">Goal: Remove (Conventional) Control Plane</a><ul><li><a href="#removing-the-control-plane-from-routers">Removing the Control Plane From Routers</a></li></ul></li><li><a href="#three-goals-of-4d-architecture">Three Goals of 4D Architecture</a></li><li><a href="#the-4d-planes">The &quot;4D&quot; Planes</a><ul><li><a href="#dissemination-and-decision-planes">Dissemination and Decision Planes</a><ul><li><a href="#good-abstractions-reduce-complexity">Good Abstractions Reduce Complexity</a></li><li><a href="#traffic-engineering-in-4d">Traffic Engineering in 4D</a></li><li><a href="#traffic-isolation-in-4d">Traffic Isolation in 4D</a></li></ul></li><li><a href="#sdn-still-have-a-control-plane-but-it-s-not-what-4d-called-a-control-plane">SDN Still Have a &quot;Control Plane&quot;, but It's Not What 4D Called a Control Plane</a></li></ul></li><li><a href="#summary">Summary</a></li></ul></li></ul></li></ul></div><p></p> <h2 id="mininet-topologies-and-mininet-python-api"><a href="#mininet-topologies-and-mininet-python-api" class="header-anchor">#</a> Mininet Topologies and Mininet Python API</h2> <h3 id="testing-a-simple-mininet-setup"><a href="#testing-a-simple-mininet-setup" class="header-anchor">#</a> Testing a Simple Mininet Setup</h3> <ul><li><p>Try setting up a simple topology with three hosts connected to a single switch:</p> <ul><li><p><code>sudo mn --test pingall --topo single,3</code></p> <p>First runs the Mininet Launcher, and then says, run a test, pingall, among the hosts in the topology. And the topology, which we specify with this topo option, is a single switch topology with three hosts connected to it.</p></li></ul></li> <li><p>This setup uses a default switch controller and switch</p> <ul><li>Mininet also allows you to use custom remote controllers (and custom switches)</li></ul></li></ul> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-02 at 02.20.12.png"> <h3 id="basic-miniet-command-line"><a href="#basic-miniet-command-line" class="header-anchor">#</a> Basic Miniet Command Line</h3> <ul><li><code>--topo</code>: defines a topology via command line upon mininet start-up</li> <li><code>--switch</code>: defines the switch to be used. By default the OVSK software switch is used</li> <li><code>--controller</code>: defines the controller to be used. If unspecified default controller is used with a default hub behavior</li></ul> <h3 id="trying-out-different-mininet-topologies"><a href="#trying-out-different-mininet-topologies" class="header-anchor">#</a> Trying Out Different Mininet Topologies</h3> <ul><li>Minimal network with two hosts and one switch
<ul><li><code>sudo mn --topo minimal</code></li></ul></li> <li>Example with 4 hosts and 4 switches
<ul><li><code>sudo mn --topo linear,4</code></li></ul></li></ul> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-02 at 02.26.04.png"> <ul><li>Example with 3 hosts all connected to one switch
<ul><li><code>sudo mn --topo single,3</code></li></ul></li> <li>Tree topology with defined depth and fan-out
<ul><li><code>sudo mn--topo tree,depth=2,fanout=2</code></li></ul></li></ul> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-02 at 02.27.58.png"> <h3 id="how-mn-works-mn-executes-python"><a href="#how-mn-works-mn-executes-python" class="header-anchor">#</a> How mn Works: mn executes Python</h3> <ul><li>&quot;mn&quot; is a launch script that executes Python</li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> mininet<span class="token punctuation">.</span>net <span class="token keyword">import</span> Mininet
<span class="token keyword">from</span> mininet<span class="token punctuation">.</span>topo <span class="token keyword">import</span> LinearTopo

Linear <span class="token operator">=</span> LinearTopo<span class="token punctuation">(</span>k<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>

net <span class="token operator">=</span> Mininet<span class="token punctuation">(</span>topo<span class="token operator">=</span>Linear<span class="token punctuation">)</span>

net<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
net<span class="token punctuation">.</span>pingAll<span class="token punctuation">(</span><span class="token punctuation">)</span>
net<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-03 at 21.04.11.png"> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-03 at 21.07.40.png"> <h3 id="writing-your-own-mininet-topologies"><a href="#writing-your-own-mininet-topologies" class="header-anchor">#</a> Writing Your Own Mininet Topologies</h3> <ul><li>Example: Two hosts, one switch</li> <li><code>mininet.cli.CLI(net)</code> before <code>net.stop()</code> will escape to interactive CLI before script terminates</li> <li><code>addLink</code> allows you to specify: Bandwidth (<code>bw</code>) in Mbps, Delay (<code>delay</code>), Maximum Queue Size (<code>max_queue_size</code>), Loss (<code>loss</code>) in percentage</li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> mininet<span class="token punctuation">.</span>net <span class="token keyword">import</span> Mininet
<span class="token keyword">from</span> mininet<span class="token punctuation">.</span>util <span class="token keyword">import</span> createLink

net <span class="token operator">=</span> Mininet<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Creating nodes in the network</span>
c0 <span class="token operator">=</span> net<span class="token punctuation">.</span>addController<span class="token punctuation">(</span><span class="token punctuation">)</span>
h0 <span class="token operator">=</span> net<span class="token punctuation">.</span>addHost<span class="token punctuation">(</span><span class="token string">'h0'</span><span class="token punctuation">)</span>
s0 <span class="token operator">=</span> net<span class="token punctuation">.</span>addSwitch<span class="token punctuation">(</span><span class="token string">'s0'</span><span class="token punctuation">)</span>
h1 <span class="token operator">=</span> net<span class="token punctuation">.</span>addHost<span class="token punctuation">(</span><span class="token string">'h1'</span><span class="token punctuation">)</span>

<span class="token comment"># Creating links between nodes in network (2-ways)</span>
net<span class="token punctuation">.</span>addLink<span class="token punctuation">(</span>h0<span class="token punctuation">,</span> s0<span class="token punctuation">)</span>
net<span class="token punctuation">.</span>addLink<span class="token punctuation">(</span>h1<span class="token punctuation">,</span> s0<span class="token punctuation">)</span>

<span class="token comment"># Configuration of IP address in interfaces</span>
h0<span class="token punctuation">.</span>setIP<span class="token punctuation">(</span><span class="token string">'192.168.1.1'</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span>
h1<span class="token punctuation">.</span>setIP<span class="token punctuation">(</span><span class="token string">'192.168.1.2'</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span>

net<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
net<span class="token punctuation">.</span>pingAll<span class="token punctuation">(</span><span class="token punctuation">)</span>
net<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="more-complicated-topology-generation"><a href="#more-complicated-topology-generation" class="header-anchor">#</a> More Complicated Topology Generation</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#!/usr/bin/python</span>

<span class="token keyword">from</span> mininet<span class="token punctuation">.</span>topo <span class="token keyword">import</span> Topo
<span class="token keyword">from</span> mininet<span class="token punctuation">.</span>net <span class="token keyword">import</span> Mininet
<span class="token keyword">from</span> mininet<span class="token punctuation">.</span>util <span class="token keyword">import</span> dumpNodeConnections
<span class="token keyword">from</span> mininet<span class="token punctuation">.</span>log <span class="token keyword">import</span> setLogLevel

<span class="token keyword">class</span> <span class="token class-name">SingleSwitchTopo</span><span class="token punctuation">(</span>Topo<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token triple-quoted-string string">'''
  Single switch connected to n hosts
  '''</span>
  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> n<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">**</span>opts<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># Initialize topology and default options</span>
    Topo<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">**</span>opts<span class="token punctuation">)</span>
    switch <span class="token operator">=</span> self<span class="token punctuation">.</span>addSwitch<span class="token punctuation">(</span><span class="token string">'s1'</span><span class="token punctuation">)</span>
    <span class="token comment"># Python's range(N) generates 0..N-1</span>
    <span class="token keyword">for</span> h <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
      host <span class="token operator">=</span> self<span class="token punctuation">.</span>addHost<span class="token punctuation">(</span><span class="token string">'h%s'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>h<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      self<span class="token punctuation">.</span>addLink<span class="token punctuation">(</span>host<span class="token punctuation">,</span> switch<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">simpleTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token triple-quoted-string string">'''
  Create and test a simple network
  '''</span>
  topo <span class="token operator">=</span> SingleSwitchTopo<span class="token punctuation">(</span>n<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>
  net <span class="token operator">=</span> Mininet<span class="token punctuation">(</span>topo<span class="token punctuation">)</span>
  net<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Dumping host connections&quot;</span><span class="token punctuation">)</span>
  dumpNodeConnections<span class="token punctuation">(</span>net<span class="token punctuation">.</span>hosts<span class="token punctuation">)</span>
  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Testing network connectivity&quot;</span><span class="token punctuation">)</span>
  net<span class="token punctuation">.</span>pingAll<span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token triple-quoted-string string">'''
  # Example of running a command on a host
  h1 = net.get('h1')
  result = h1.cmd('ifconfig')
  print(result)
  '''</span>

  net<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
  <span class="token comment"># Tell mininet to print useful information</span>
  setLogLevel<span class="token punctuation">(</span><span class="token string">'info'</span><span class="token punctuation">)</span>
  simpleTest<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-03 at 23.32.25.png"> <p><code>ifconfig</code> result</p> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-03 at 23.35.46.png"> <h3 id="thing-not-covered"><a href="#thing-not-covered" class="header-anchor">#</a> Thing Not Covered</h3> <ul><li>Access to filesystem</li> <li>Setting link speeds and properties</li> <li>Using custom controllers and switches</li> <li>Host configuration</li> <li>Performance measurement</li></ul> <h2 id="mininet-instructions"><a href="#mininet-instructions" class="header-anchor">#</a> Mininet Instructions</h2> <h3 id="notations"><a href="#notations" class="header-anchor">#</a> Notations</h3> <table><thead><tr><th>notation</th> <th>explanation</th></tr></thead> <tbody><tr><td>mininet&gt;</td> <td>mininet specific commands are typed here</td></tr> <tr><td>$</td> <td>linux commands with user level privileges are typed here</td></tr> <tr><td>#</td> <td>command with sudo level access are typed here</td></tr></tbody></table> <h3 id="command-breakdown"><a href="#command-breakdown" class="header-anchor">#</a> Command Breakdown</h3> <ul><li><p><code>sudo mn</code>: This starts mininet. Mininet always requires sudo to run</p></li> <li><p><code>--topo single,3</code>: This tells mininet to start using the topology of a ‘single’ switch and 3 hosts</p></li> <li><p><code>--mac</code>: This tells mininet to assign each host a sequential mac address, matching its IP address</p></li> <li><p><code>--switch ovsk</code>: This tells mininet that the switches are to be of the type ovsk, this is the type for Openflow</p></li> <li><p><code>--controller remote</code>: This tells mininet that each Openflow switch is to talk to a controller, which is located at a remote location</p></li></ul> <h3 id="mininet-basic-commands"><a href="#mininet-basic-commands" class="header-anchor">#</a> Mininet Basic Commands</h3> <ul><li>To see the list of nodes available, in the Mininet console, run:</li></ul> <p><code>mininet&gt; nodes</code></p> <ul><li>To see a list of available commands, in the Mininet console, run:</li></ul> <p><code>mininet&gt; help</code></p> <ul><li>To check the IP of a virtual host, in the Mininet console, run:</li></ul> <p><code>mininet&gt; h2 ifconfig</code></p> <ul><li>The alternative - better for running interactive commands and watching debug output - is to spawn an xterm for one or more virtual hosts. In the Mininet console, run:</li></ul> <p><code>mininet&gt; xterm h2 h3</code></p> <ul><li>If Mininet is not working correctly (or has crashed and needs to be restarted), first quit Mininet if necessary (using the exit command, or control-D), and then try clearing any residual state or processes using:</li></ul> <p><code>$ sudo mn -c</code> and running Mininet again</p> <ul><li>Using dpctl</li></ul> <p>dpctl is a utility that comes with the OpenFlow reference distribution and enables visibility and control over a single switch’s flow table. It is especially useful for debugging, by viewing flow state and flow counters. Most OpenFlow switches can start up with a passive listening port (in your current setup this is 6634), from which you can poll the switch, without having to add debugging code to the controller.</p> <p>Create a second SSH window if you don’t already have one, and run:</p> <p><code>$ dpctl show tcp:127.0.0.1:6634</code></p> <p>The <code>show</code> command connects to the switch and dumps out its port state and capabilities. Here’s a more useful command:</p> <p><code>$ dpctl dump-flows tcp:127.0.0.1:6634</code></p> <h3 id="ping-test"><a href="#ping-test" class="header-anchor">#</a> Ping Test</h3> <p><code>mininet&gt; h2 ping -c3 h3</code></p> <p>Note that the name of host h3 is automatically replaced when running commands in the Mininet console with its IP address (10.0.0.3).</p> <p>As you saw before, switch flow table is empty. Besides that, there is no controller connected to the switch and therefore the switch doesn’t know what to do with incoming traffic, leading to ping failure.</p> <p>You’ll use dpctl to manually install the necessary flows. In your SSH terminal:</p> <p><code>$ dpctl add-flow tcp:127.0.0.1:6634 in_port=2,actions=output:3</code></p> <p><code>$ dpctl add-flow tcp:127.0.0.1:6634 in_port=3,actions=output:2</code></p> <p>This will forward packets coming at port 2 to port 3 and vice-versa. Verify by checking the flow-table:</p> <p><code>$ dpctl dump-flows tcp:127.0.0.1:6634</code></p> <p>Run the ping command again. In your mininet console:</p> <p><code>mininet&gt; h2 ping -c3 h3</code></p> <p>Do you get replies now? Check the flow-table again and look the statistics for each flow entry. Is this what you expected to see based on the ping traffic? NOTE: if you didn’t see any ping replies coming through, it might be the case that the flow-entries expired before you start your ping test. When you do a ”dpctl dump-flows” you can see an ”idle timeout” option for each entry. This means that the flow will expire after this many secs if there is no incoming traffic. Run again respecting this limit, or install a flow-entry with longer timeout.</p> <p><code>$ dpctl add-flow tcp:127.0.0.1:6634 in_port=2,idle_timeout=120,actions=output:3</code></p> <h3 id="benchmark-controller-with-iperf"><a href="#benchmark-controller-with-iperf" class="header-anchor">#</a> Benchmark Controller with iperf</h3> <p>iperf is a command-line tool for checking speeds between two computers. Here, you'll benchmark the reference controller. In your SSH terminal:</p> <p><code>$ controller ptcp:</code></p> <p>This will start a simple controller that acts as a learning switch without installing any flow-entries.</p> <p>Now, in the mininet console run:</p> <p><code>mininet&gt; iperf</code></p> <p>This Mininet command runs an iperf TCP server on one virtual host, then runs an iperf client on a second virtual host. Once connected, they blast packets between each other and report the results.</p> <p>Now compare with the user-space switch. In the mininet console:</p> <p><code>mininet&gt; exit</code></p> <p>Start the same Mininet with the user-space switch:</p> <p><code>$ sudo mn --topo single,3 --controller remote --switch user</code></p> <blockquote><p>Note: As pointed by many on the discussion forum the &quot;--mac&quot; flag causes user-space switch to fail when performing iperf or ping tests. A tourble-ticket has been generated on the mininet github to resolve this issue. In the meantime, I have omitted the &quot;--mac&quot; flag and it should work for now.</p></blockquote> <p>Here we have used <code>user</code> with --switch option instead of <code>ovsk</code>. This loads mininet with user-space switch. Run one more iperf test with the reference controller:</p> <p><code>mininet&gt; iperf</code></p> <p>See a difference? With the user-space switch, packets must cross from user-space to kernel-space and back on every hop, rather than staying in the kernel as they go through the switch. The user-space switch is easier to modify, but slower for simulation.</p> <h3 id="changing-link-parameters"><a href="#changing-link-parameters" class="header-anchor">#</a> Changing Link Parameters</h3> <p>Mininet 2.0 allows you to set link parameters. In the SSH terminal, run mininet with following settings:</p> <p><code>$ sudo mn --topo single,3 --mac --controller remote --switch ovsk --link tc,bw=10,delay=10ms</code></p> <p>Now, in the mininet console:</p> <p><code>mininet&gt; h1 ping -c10 h2</code></p> <p>As the delay for each link is 10 ms, the round trip time (RTT) should be about 40 ms, since the ICMP request traverses two links (one to the switch, one to the destination) and the ICMP reply traverses two links coming back.</p> <h3 id="terms"><a href="#terms" class="header-anchor">#</a> Terms</h3> <ul><li><p>OpenFlow Interface: a standard open interface between the OpenFlow controller and the OpenFlow programmable devices (i.e., switches etc)</p></li> <li><p>OpenFlow Controller: sits above the OpenFlow interface. The OpenFlow reference distribution includes a controller that acts as an Ethernet learning switch in combination with an OpenFlow switch. You'll run it and look at messages being sent.</p></li> <li><p>OpenFlow Switch: sits below the OpenFlow interface. The OpenFlow reference distribution includes a user-space software switch. Open vSwitch is another software but kernel-based switch, while there is a number of hardware switches available from Broadcom (Stanford Indigo release), HP, NEC, and others.</p></li> <li><p>dpctl: command-line utility that sends quick OpenFlow messages, useful for viewing switch port and flow stats, plus manually inserting flow entries.</p></li> <li><p>Wireshark: general (non-OF-specific) graphical utility for viewing packets. The OpenFlow reference distribution includes a Wireshark dissector, which parses OpenFlow messages sent to the OpenFlow default port (6633) in a conveniently readable way.</p></li> <li><p>iperf: general command-line utility for testing the speed of a single TCP connection.</p></li> <li><p>Mininet: network emulation platform. Mininet creates a virtual OpenFlow network - controller, switches, hosts, and links - on a single real or virtual machine. More Mininet details can be found at the Mininet web page .</p></li> <li><p>cbench: utility for testing the flow setup rate of OpenFlow controllers.</p></li></ul> <h2 id="control-data-separation"><a href="#control-data-separation" class="header-anchor">#</a> Control/Data Separation</h2> <ul><li>Learning Objectives
<ul><li>Be able to explain the difference between control and data plane</li> <li>What is the function of each?
<ul><li>Provide examples of functions performed by each</li> <li>Describe the infrastructure the supports the control plane and the data plane</li></ul></li> <li>What are the challenges of separation?</li></ul></li></ul> <h3 id="overview"><a href="#overview" class="header-anchor">#</a> Overview</h3> <h4 id="what-is-control-data-separation"><a href="#what-is-control-data-separation" class="header-anchor">#</a> What is control/data separation?</h4> <ul><li>Control Plane: Logic for controlling forwarding behavior
<ul><li>Examples: routing protocols, network middlebox configuration</li></ul></li> <li>Data Plane: Forward traffic according to control plane logic
<ul><li>Examples: IP forwarding, Layer 2 switching</li></ul></li></ul> <h4 id="why-separate-the-control-and-data-planes"><a href="#why-separate-the-control-and-data-planes" class="header-anchor">#</a> Why Separate the Control and Data Planes?</h4> <ul><li><strong>Independent evolution and development</strong> <ul><li>The software control of the network can evolve independently of the hardware</li></ul></li> <li><strong>Control from high-level software program</strong> <ul><li>Control behavior using higher-order programs</li> <li>Debug/check behavior more easily</li></ul></li></ul> <h4 id="opportunities-where-separation-helps"><a href="#opportunities-where-separation-helps" class="header-anchor">#</a> Opportunities: Where Separation Helps</h4> <ul><li><strong>Data centers</strong>: VM migration, Layer 2 routing</li> <li><strong>Routing</strong>: More control over decision logic</li> <li><strong>Enterprise networks</strong>: Security applications</li> <li><strong>Research networks</strong>: Coexistence with production</li></ul> <h4 id="example-data-centers-yahoo"><a href="#example-data-centers-yahoo" class="header-anchor">#</a> Example: Data Centers (Yahoo!)</h4> <ul><li>20000 servers/cluster = 400000 VMs
<ul><li>Any-to-any, 1024 distinct 不同的 inter-host links</li> <li>Sub-second migration, guaranteed consistency</li></ul></li> <li><strong>Problem</strong>: Keeping 20k devices in sync with 400k+ entities?</li> <li><strong>Solution</strong>: Program switch from a central database</li></ul> <h4 id="example-at-t-irscp-commercial-rcp-remote-procedure-call"><a href="#example-at-t-irscp-commercial-rcp-remote-procedure-call" class="header-anchor">#</a> Example: AT&amp;T IRSCP (commercial RCP (remote procedure call))</h4> <ul><li>Filtering attack traffic
<ul><li>Measurement system detects an attack</li> <li>Identify entry point and victim of attack</li> <li>Drop offending traffic at the entry point</li></ul></li></ul> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-04 at 01.37.00.png"> <h4 id="two-continual-challenges"><a href="#two-continual-challenges" class="header-anchor">#</a> Two Continual Challenges</h4> <ul><li><strong>Scalability</strong>: Control elements responsible for many forwarding elements (often, thousands)</li> <li><strong>Reliability/Security</strong>: What happens when a controller fails or is compromised?</li></ul> <h3 id="opportunities-in-various-domains"><a href="#opportunities-in-various-domains" class="header-anchor">#</a> Opportunities in various domains</h3> <ul><li>New routing services in the wide area
<ul><li>Maintenance</li> <li>Egress selection</li> <li>Security</li></ul></li> <li>Data centers
<ul><li>Cost</li> <li>Management</li></ul></li></ul> <h4 id="interdomain-routing-constrained-policies"><a href="#interdomain-routing-constrained-policies" class="header-anchor">#</a> Interdomain Routing: Constrained Policies</h4> <ul><li>Today's interdomain routing protocol, BGP, artificially constrains routes
<ul><li>Route selection is based on a fixed set of steps</li> <li>There are limited knobs to control inbound/outbound traffic</li> <li>Very difficult to incorporate other information (e.g., auxiliary information, time of day)</li></ul></li> <li><strong>Instead</strong>: Route controller can directly update state</li></ul> <h4 id="example-maintenance-dry-out"><a href="#example-maintenance-dry-out" class="header-anchor">#</a> Example: Maintenance Dry-out</h4> <ul><li>Planned maintenance on an edge router</li></ul> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-04 at 23.28.57.png"> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-04 at 23.29.38.png"> <h4 id="example-egress-selection"><a href="#example-egress-selection" class="header-anchor">#</a> Example: Egress Selection</h4> <ul><li>Customer-controlled egress 出口 selection
<ul><li>Multiple ways to reach the same destination</li> <li>Giving customers control over the decision</li></ul></li></ul> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-04 at 23.33.47.png"> <h4 id="example-better-bgp-security"><a href="#example-better-bgp-security" class="header-anchor">#</a> Example: Better BGP Security</h4> <ul><li>Better interdomain routing security
<ul><li>Anomaly 反常的事物 detection to detect bogus 假的 routes</li> <li>Prefer &quot;familiar&quot; routers over unfamiliar</li></ul></li></ul> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-04 at 23.36.52.png"> <h4 id="example-data-centers-cost"><a href="#example-data-centers-cost" class="header-anchor">#</a> Example: Data Centers (Cost)</h4> <ul><li>Cost</li></ul> <p>200000 servers</p> <p>Fanout (the number of the inputs that can be connected to a specified output) of 20 -&gt; 10000 switches</p> <p><code>$5k</code> vendor switch = <code>$50M</code></p> <p><code>$1k</code> commodity switch = <code>$10M</code></p> <p>Savings in 10 data centers = <code>$400M</code></p> <ul><li>Control</li></ul> <p>More flexible control</p> <p>Tailor 定制 network for services</p> <p>Quickly improve and innovate</p> <h4 id="example-data-center-addressing"><a href="#example-data-center-addressing" class="header-anchor">#</a> Example: Data Center Addressing</h4> <ul><li>How to address hosts in a data center?
<ul><li><strong>Layer 2</strong>: Less configuration/administration, but bad scaling properties</li> <li><strong>Layer 3</strong>: Can use existing routing protocols, but high administration overhead</li></ul></li> <li>How to get the best of both worlds?
<ul><li>Separate Controller
<ul><li>Topology-dependent MAC addressing</li> <li>IP addressing for application compatibility</li></ul></li></ul></li></ul> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-04 at 23.50.18.png"> <blockquote><p>So as we know, if a particular host wants to send traffic to another host IP address, it will use the address resolution protocol, or ARP, to send out a broadcast query that asks, who has a particular IP address? In other words, what is the MAC address for this particular IP address, that I would like to send to? And the trick here is that we don't want the host, the destination host, to respond. Because it still thinks it has its old MAC address. What we can do in this case, because we have separate network control, is to use something they call a fabric manager, or a separate controller to basically intercept all of these rqueries. Or all these queries that are wanting to discover MAC addresses for particular IP addresses. So in this particular switch, receives a query that says, tell me the MAC address for a particular IP address. That switch can kick that query to a central controller or a fabric manager which can then reply with the topology dependent pseudo MAC, or P MAC. And then all of the traffic can be rewritten with the appropriate source and destination topology dependent MAC addresses. So that's just one example of how a separate controller and a data center can allow a network administrator to get the best of both worlds.</p></blockquote> <h4 id="other-opportunities"><a href="#other-opportunities" class="header-anchor">#</a> Other Opportunities</h4> <ul><li>Dynamic access control</li> <li>Seamless 不间断的 mobility 流动性/migration</li> <li>Server load balancign</li> <li>Network virtualization</li> <li>Using multiple wireless access points</li> <li>Energy-efficient networking</li> <li>Adaptive traffic monitoring</li> <li>Denial-of-Service attack detection</li></ul> <h3 id="challenges-in-separating-the-data-and-control-planes"><a href="#challenges-in-separating-the-data-and-control-planes" class="header-anchor">#</a> Challenges in Separating the Data and Control Planes</h3> <ul><li>Challenges from control and data separation</li> <li>Overview of challenges
<ul><li><strong>Scalability</strong>: Routing decisions for many routers</li> <li><strong>Reliability</strong>: Correct operation under failure</li> <li><strong>Consistency</strong>: Ensuring consistency across multiple control replicas</li></ul></li> <li>Approaches to solving these challenges in RCP (routing control platform), ONIX</li></ul> <h4 id="scalability-rcp"><a href="#scalability-rcp" class="header-anchor">#</a> Scalability: RCP</h4> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-06 at 10.46.22.png"> <ul><li>Problem: Must store routers and compute routing decisions for every router</li> <li>Potentially thousands of routers</li></ul> <h5 id="scalability-principles-from-rcp-design"><a href="#scalability-principles-from-rcp-design" class="header-anchor">#</a> Scalability: Principles from RCP Design</h5> <ul><li><p>Eliminate redundancy 冗余</p> <ul><li>Store a single copy of each route</li> <li>Avoid redundant computation</li></ul></li> <li><p>Accelerate lookups</p> <ul><li>Maintain indexes to identify affected routers</li></ul></li> <li><p>Only perform BGP routing</p></li></ul> <blockquote><p>Finally, RCP tackles some scalability problems by simply punting on performing routing for all the routing protocols in the network and simply decides to focus on performing inter-domain routing alone.</p></blockquote> <h4 id="scalability-onix"><a href="#scalability-onix" class="header-anchor">#</a> Scalability: ONIX</h4> <ul><li><strong>Partitioning</strong>: Only keep a subset of the overall network information base (NIB) in memory
<ul><li>Various consistency protocols to maintain consistency across different partitions</li> <li>Two different consistency models
<ul><li>Strong consistency model: ensure that different replicas are strongly consistent at the expense of some performance</li> <li>Weaker consistency model: more efficient about passing information around more quickly</li></ul></li></ul></li> <li><strong>Aggregation</strong>: Use of hierarchy (e.g., Onix controllers per department or building)
<ul><li>Combine statistics, topology information</li></ul></li></ul> <h4 id="reliability-rcp"><a href="#reliability-rcp" class="header-anchor">#</a> Reliability: RCP</h4> <ul><li>Replicate 复制 RCPs (&quot;Hot Spare&quot;)
<ul><li>Run multiple identical servers in parallel</li></ul></li> <li>Run independent replicas
<ul><li>Each replica has its own feed of routes</li> <li>Each replica receives the same inputs and runs the same routing algorithm</li> <li>No need for a consistency protocol if both replicas always see the same information</li></ul></li></ul> <h5 id="potential-consistency-problem"><a href="#potential-consistency-problem" class="header-anchor">#</a> Potential Consistency Problem</h5> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-07 at 00.01.09.png"> <ul><li><p>Route assignments must be consistent</p> <ul><li>Even in presence of failures and partitions</li></ul></li> <li><p>Fortunately</p> <ul><li>Flooding-based IGP means each replica knows which partitions it connects to</li></ul></li></ul> <h6 id="single-rcp-under-partition"><a href="#single-rcp-under-partition" class="header-anchor">#</a> Single RCP Under Partition</h6> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-07 at 00.05.10.png"> <ul><li>Solution: Only use state from routers partition in assigning its routes
<ul><li>Ensures next hop is reachable</li></ul></li></ul> <h6 id="multiple-rcps-under-partition"><a href="#multiple-rcps-under-partition" class="header-anchor">#</a> Multiple RCPs Under Partition</h6> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-07 at 00.05.48.png"> <ul><li>Solution: RCPs receive same state from each partition they can reach
<ul><li>IGP provides complete visibility, connectivity</li> <li>Only acts on partition if it has complete state</li></ul></li></ul> <h4 id="reliability-onix"><a href="#reliability-onix" class="header-anchor">#</a> Reliability: ONIX</h4> <ul><li><strong>Network failures</strong>: application's responsibility</li> <li><strong>Reachability to ONIX</strong>: reliable protocol, multipath, etc.</li> <li><strong>ONIX failure</strong>: distributed coordination 协调 amongst 其中 replicas</li></ul> <h3 id="summary"><a href="#summary" class="header-anchor">#</a> Summary</h3> <ul><li><p>Control and data plane separation pose three significant challenges</p> <ul><li><strong>Scalability</strong>: Routing decisions for many routers</li> <li><strong>Reliability</strong>: Correct operation under failure</li> <li><strong>Consistency</strong>: Ensuring consistency across multiple control replicas</li></ul></li> <li><p>Hierarchy, aggregation, clever state management and distribution</p></li></ul> <h2 id="routing-control-platform"><a href="#routing-control-platform" class="header-anchor">#</a> Routing Control Platform</h2> <ul><li>Problems with BGP</li> <li>Routing Control Platform
<ul><li>Early example of control/data separation</li> <li>Three deployment phases (&quot;getting from here to there&quot;)</li> <li>Applications at each stage of deployment</li></ul></li></ul> <h3 id="problems-with-bgp"><a href="#problems-with-bgp" class="header-anchor">#</a> Problems with BGP</h3> <ul><li><p>BGP is broken</p> <ul><li>It converges 趋于一致 slowly, sometimes not at all</li> <li>It causes routing loops</li> <li>It's misconfigured frequently</li> <li>Traffic engineering is hard</li></ul></li> <li><p>Fixing BGP is hard</p> <ul><li>Incremental fixes: Makes BGP even more complicated</li> <li>New architectures and inter-domain protocols: Deployment is almost impossible</li></ul></li> <li><p>AS is the logical entity for inter-domain</p> <ul><li>BGP state, logic are decomposed across routers</li> <li>No router has complete BGP state</li> <li>Each router makes routing decision based on partial and incomplete view</li></ul></li> <li><p>BGP interacts in odd ways with other protocols</p> <ul><li>Most notably 尤其 with the IGP (Interior Gateway Protocol) running inside an AS</li></ul></li></ul> <h3 id="routing-control-platform-2"><a href="#routing-control-platform-2" class="header-anchor">#</a> Routing Control Platform</h3> <ul><li>Represents as AS as a single logical entity
<ul><li>Complete view of AS's routes</li> <li>Computes routes for all routers inside an AS
<ul><li>Routers no longer have to compute routes</li></ul></li></ul></li> <li>Exchanges routing with RCPs in other ASes</li></ul> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-07 at 11.43.17.png"> <h4 id="decomposed-configureation-state"><a href="#decomposed-configureation-state" class="header-anchor">#</a> Decomposed Configureation State</h4> <blockquote><p>One of the problems with BGP is that configuration state is decomposed across the routers inside a single autonomous system. So representing a single coherent network wide policy is quite difficult.</p></blockquote> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-07 at 11.57.01.png"> <ul><li>Assign routes &quot;From UUNet&quot; tag at router C</li> <li>Don't send route with &quot;From UUNet&quot; tag to Sprint at router A</li></ul> <h5 id="rcp-centralize-configuration"><a href="#rcp-centralize-configuration" class="header-anchor">#</a> RCP: Centralize COnfiguration</h5> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-07 at 11.59.15.png"> <ul><li>RCP implements policies for entire AS
<ul><li>Knows about sessions to all other ASes</li> <li>Implements policies in terms of relationship with ASes</li></ul></li> <li>Benefits
<ul><li>Simpler configuration</li> <li>Do not have to tag routes with state</li></ul></li></ul> <h3 id="bgp-interacts-with-underlying-protocols"><a href="#bgp-interacts-with-underlying-protocols" class="header-anchor">#</a> BGP Interacts with Underlying Protocols</h3> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-07 at 12.01.58.png"> <p>C1 learns BGP route to destination D from RR1</p> <p>C2 learns BGP route to destination D from RR2</p> <p>C1 sends packets to RR1 via its IGP shortest path which traverses 穿过 C2</p> <p>C2 sends packets to RR2 via its IGP shortest path which traverses C1</p> <ul><li>Persistent forwarding loop: packets to destination D</li></ul> <h4 id="rcp-compute-routes-w-complete-info"><a href="#rcp-compute-routes-w-complete-info" class="header-anchor">#</a> RCP: Compute Routes w/Complete info</h4> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-07 at 12.07.16.png"> <ul><li>RCP learns all externally learned routes</li> <li>Computes consistent router-level paths</li> <li>Benefits:
<ul><li>Intrinsic 真正的 loop freedom and convergence 汇聚</li> <li>RCP does not have to stick to BGP decision process</li> <li>Can &quot;pin&quot; paths for traffic engineering and other purposes</li></ul></li></ul> <h4 id="getting-from-here-to-there"><a href="#getting-from-here-to-there" class="header-anchor">#</a> Getting From Here to There</h4> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-07 at 12.21.02.png"> <ul><li>Two issues
<ul><li>Backward compatibility</li> <li>Deployment incentives</li></ul></li></ul> <h5 id="phase-1-control-protocol-interactions"><a href="#phase-1-control-protocol-interactions" class="header-anchor">#</a> Phase 1: Control Protocol Interactions</h5> <p>Before: conventional iBGP</p> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-07 at 16.43.32.png"> <p>After: RCP gets &quot;best&quot; iBGP routes (and IGP topology)</p> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-07 at 16.44.20.png"> <p><strong>Only one AS has to change</strong></p> <h6 id="application-controlling-path-changes"><a href="#application-controlling-path-changes" class="header-anchor">#</a> Application: Controlling Path Changes</h6> <p>BGP routes take &quot;nearest exit&quot; (shortest IGP path)</p> <p>Failures or maintenance can change IGP (path) weights</p> <p><strong>RCP can &quot;pin&quot; exit points as IGP weights change</strong></p> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-07 at 16.48.02.png"> <h5 id="phase-2-as-wide-policy"><a href="#phase-2-as-wide-policy" class="header-anchor">#</a> Phase 2: AS-Wide Policy</h5> <p>Before: RCP gets &quot;best&quot; iBGP routes (and IGP topoloty)</p> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-07 at 16.49.09.png"> <p>After: RCP gets all eBGP routes from neighbors</p> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-07 at 16.49.41.png"> <h6 id="application-efficient-aggregation"><a href="#application-efficient-aggregation" class="header-anchor">#</a> Application: Efficient Aggregation</h6> <p>Aggregation curbs routing table growth</p> <p><strong>Routers can't know which routers need more specific routes</strong></p> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-07 at 16.51.15.png"> <p><strong>RCP can determine which routers need more specific routes and which routers can get by with less specific routes</strong></p> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-07 at 16.53.28.png"> <h5 id="phase-3-all-ases-have-rcps"><a href="#phase-3-all-ases-have-rcps" class="header-anchor">#</a> Phase 3: All ASes Have RCPs</h5> <p>Before: RCP gets all eBGP routes from neighbors</p> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-07 at 16.54.53.png"> <p>After: ASes exchange routes via RCP</p> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-07 at 16.55.25.png"> <h6 id="application-more-flexible-routing"><a href="#application-more-flexible-routing" class="header-anchor">#</a> Application: More Flexible Routing</h6> <ul><li>Better network management
<ul><li>Diagnostics and trouble-shooting</li> <li>Routing co-located with other information (e.g. traffic)</li> <li>Ability to reason about as AS as a single entity</li></ul></li> <li>Protocol Improvements
<ul><li>Attaching prices to routes</li> <li>Inter-AS negotiation of exit points</li> <li>Overlay routing informed by IP-layer information</li></ul></li></ul> <h3 id="summary-2"><a href="#summary-2" class="header-anchor">#</a> Summary</h3> <ul><li>RCP embodies two principles for inter-domain routing
<ul><li>Treat an AS as a single logical entity
<ul><li>Compute consistent routes using complete AS-wide view</li></ul></li> <li>Control routing protocol interactions</li></ul></li> <li>Benefits
<ul><li>Simpler, more expressive configuration</li> <li>Intrinsic robustness: no loops, faster convergence</li> <li>Enable new applications and innovations
<ul><li>Opportunity for new traffic engineering applications</li></ul></li></ul></li></ul> <h2 id="the-4d-network-architecture"><a href="#the-4d-network-architecture" class="header-anchor">#</a> The 4D Network Architecture</h2> <ul><li>The &quot;4D&quot; Network Architecture
<ul><li>Motivation</li> <li>Defining the 4Ds</li></ul></li> <li>How 4D Terminology 术语 Relates to SDN Today</li></ul> <h3 id="conventional-ip-routers"><a href="#conventional-ip-routers" class="header-anchor">#</a> Conventional IP Routers</h3> <ul><li>Management plane
<ul><li>Construct network-wide view</li> <li>Configure the routers</li></ul></li> <li>Control plane
<ul><li>Track topology changes</li> <li>Compute routes and install forwarding tables</li></ul></li> <li>Data plane
<ul><li>Forward, filter, buffer, mark, and rate-limit packets</li> <li>Collect traffic statistics</li></ul></li></ul> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-07 at 23.28.03.png"> <h3 id="goal-remove-conventional-control-plane"><a href="#goal-remove-conventional-control-plane" class="header-anchor">#</a> Goal: Remove (Conventional) Control Plane</h3> <ul><li>Faster innovation
<ul><li>Remove dependence on vendors and the IETF</li></ul></li> <li>Simpler management systems
<ul><li>No need to &quot;invert&quot; control-plane operations</li></ul></li> <li>Easier interoperability between vendors
<ul><li>Compatibility necessary only in &quot;wire&quot; protocols</li></ul></li> <li>Simpler, cheaper routers
<ul><li>Little or no software on the routers</li></ul></li></ul> <h4 id="removing-the-control-plane-from-routers"><a href="#removing-the-control-plane-from-routers" class="header-anchor">#</a> Removing the Control Plane From Routers</h4> <ul><li>Control software can run elsewhere</li> <li>State and computation is reasonable</li> <li>System overhead can be amortized 分期偿还</li> <li>Easier access to other information</li> <li>Some control can move to end hosts</li></ul> <h3 id="three-goals-of-4d-architecture"><a href="#three-goals-of-4d-architecture" class="header-anchor">#</a> Three Goals of 4D Architecture</h3> <ul><li><p>Network-level objectives</p> <ul><li>Configure the network, not the routers</li> <li>Minimize the maximum link utilization</li> <li>Connectivity under all layer-two failures</li></ul></li> <li><p>Network-wide views</p> <ul><li>Complete visibility to drive decision-making</li> <li>Traffic matrix, network topology, equipment</li></ul></li> <li><p>DIrect control</p> <ul><li>Direct, sole 底 control over data-plane configuration</li> <li>Packet forwarding, filtering, marking, buffering...</li></ul></li></ul> <h3 id="the-4d-planes"><a href="#the-4d-planes" class="header-anchor">#</a> The &quot;4D&quot; Planes</h3> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-08 at 00.09.51.png"> <ul><li><strong>Decision</strong>: all management and control</li> <li><strong>Dissemination</strong>传播: communication to/from routers</li> <li><strong>Discovery</strong>: topology and traffic monitoring</li> <li><strong>Data</strong>: traffic handling</li></ul> <h4 id="dissemination-and-decision-planes"><a href="#dissemination-and-decision-planes" class="header-anchor">#</a> Dissemination and Decision Planes</h4> <ul><li><strong>Decision Plane</strong>: Functions that operate on <strong>view of entire network</strong> and network objectives
<ul><li>Path selection and traffic engineering</li> <li>Reachability control and VPNs</li></ul></li> <li><strong>Dissemination Plane</strong>: Functions that <strong>support creation of a network-wide view</strong> <ul><li>Topology discovery</li> <li>Report measurements, status, resources</li> <li>Install state (e.g. FIBs, ACLs) into data-plane</li></ul></li></ul> <h5 id="good-abstractions-reduce-complexity"><a href="#good-abstractions-reduce-complexity" class="header-anchor">#</a> Good Abstractions Reduce Complexity</h5> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-08 at 00.18.11.png"> <ul><li>Dissemination plane is a control channel between the decision plane and the data plane</li> <li>Routing protocols become a control channel. Complex logic in decision plane</li></ul> <h5 id="traffic-engineering-in-4d"><a href="#traffic-engineering-in-4d" class="header-anchor">#</a> Traffic Engineering in 4D</h5> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-08 at 00.38.03.png"> <ul><li><strong>Dissemination Plane</strong>: Consistent network-wide view</li> <li><strong>Decisioin Plane</strong>: Decision Logic that directly expresses desired solution</li></ul> <h5 id="traffic-isolation-in-4d"><a href="#traffic-isolation-in-4d" class="header-anchor">#</a> Traffic Isolation in 4D</h5> <img src="https://augists-upic.oss-cn-qingdao.aliyuncs.com/uPic/Screen Shot 2022-08-08 at 00.41.25.png"> <ul><li>Decision Plane
<ul><li>Reachability matrix <strong>directly expresses</strong> goal</li> <li>Path computation can <strong>jointly</strong> optimize traffic load and obey reachability constraints 限制</li></ul></li> <li>Packet filters installed only where needed</li></ul> <h4 id="sdn-still-have-a-control-plane-but-it-s-not-what-4d-called-a-control-plane"><a href="#sdn-still-have-a-control-plane-but-it-s-not-what-4d-called-a-control-plane" class="header-anchor">#</a> SDN Still Have a &quot;Control Plane&quot;, but It's Not What 4D Called a Control Plane</h4> <ul><li>What the 4D calls the &quot;control plane&quot; is actually distributed routing protocols</li> <li>What we refer to as the &quot;control plane&quot; today is the decision plane&quot; in 4D</li> <li>The &quot;dissemination plane&quot; lives on, but we call it a &quot;control channel&quot;
<ul><li>In RCP, dissemination plane is BGP</li> <li>In OpenFlow, it's &quot;secchan&quot;</li></ul></li></ul> <h3 id="summary-3"><a href="#summary-3" class="header-anchor">#</a> Summary</h3> <ul><li><p>Four layers</p> <ul><li><strong>Data</strong>: for processing packets</li> <li><strong>Discovery</strong>: for collecting topology and traffic information</li> <li><strong>Dissemination</strong>: installing packet-processing rules</li> <li><strong>Decision</strong>: logically centralized controllers convert objectives into packet-handling state</li></ul></li> <li><p>4D is a generalization of RCP</p> <ul><li>Others followed up with more general implementations that didn't just focus on routing, but also achieved other network level objectives, and ultimately used other protocols besides routing protocols as the as the dissemination plane</li></ul></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/SDN-Notes/SDN/Module1.html" class="prev">
        Module 1: History and evolution of SDN
      </a></span> <span class="next"><a href="/SDN-Notes/SDN/Module3.html">
        Module 3: Virtual networking
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/SDN-Notes/assets/js/app.ebe7fed2.js" defer></script><script src="/SDN-Notes/assets/js/2.4a1859a1.js" defer></script><script src="/SDN-Notes/assets/js/9.c2f25c60.js" defer></script>
  </body>
</html>
